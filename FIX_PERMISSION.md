# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞

## –û—à–∏–±–∫–∞: "The caller does not have permission"

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å Apps Script API.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ Apps Script API

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** https://script.google.com/home/usersettings
2. **–ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:** "Google Apps Script API"
3. **–í–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å** (–¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å —Å–∏–Ω–∏–º/–≤–∫–ª—é—á–µ–Ω–Ω—ã–º)
4. **–ù–∞–∂–º–∏—Ç–µ:** "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" (–µ—Å–ª–∏ –µ—Å—Ç—å)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–µ–∫—Ç

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Apps Script:**
   ```
   https://script.google.com/home/projects/1Vy89JyxPu02_0k9LUsI18xHo1pScQ4hzs1BqRiAJKrxIDasieXjE-pAc/edit
   ```

2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** –∏ –≤—ã –≤–∏–¥–∏—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞

### –®–∞–≥ 3: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è API, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cd /Users/aleksandrprokudin/Documents/GW
clasp push
```

–ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:

```bash
clasp push --force
```

---

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä—É—á–Ω—É—é

–ï—Å–ª–∏ clasp –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–¥ –≤—Ä—É—á–Ω—É—é:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Apps Script:**
   https://script.google.com/home/projects/1Vy89JyxPu02_0k9LUsI18xHo1pScQ4hzs1BqRiAJKrxIDasieXjE-pAc/edit

2. **–£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª Code.gs** (–µ—Å–ª–∏ –µ—Å—Ç—å)

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã:**
   - –ù–∞–∂–º–∏—Ç–µ "+" ‚Üí "–§–∞–π–ª" ‚Üí "–°–∫—Ä–∏–ø—Ç" ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ `appsScript.js`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `appsScript.js`
   
   - –ù–∞–∂–º–∏—Ç–µ "+" ‚Üí "–§–∞–π–ª" ‚Üí "HTML" ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ `dialog.html`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `dialog.html`
   - **–í–ê–ñ–ù–û:** –ó–∞–º–µ–Ω–∏—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏!

   - –ù–∞–∂–º–∏—Ç–µ "+" ‚Üí "–§–∞–π–ª" ‚Üí "JSON" ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ `appsscript.json`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `appsscript.json`

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã**

---

## ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

–ö–æ–≥–¥–∞ –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è (—á–µ—Ä–µ–∑ clasp –∏–ª–∏ –≤—Ä—É—á–Ω—É—é), –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub Secrets:

1. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω:**
   ```bash
   cat ~/.clasprc.json
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ GitHub:**
   - https://github.com/alxprokudin/my-workspace-addons/settings/secrets/actions
   - `CLASP_TOKEN` = —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `~/.clasprc.json`
   - `CLASP_SCRIPT_ID` = `1Vy89JyxPu02_0k9LUsI18xHo1pScQ4hzs1BqRiAJKrxIDasieXjE-pAc`

