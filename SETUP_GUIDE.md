# üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:
‚úÖ Node.js —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (v20.10.0)
‚úÖ npm —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (10.9.0)
‚úÖ clasp —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

## –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
clasp login --status
```

–ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
clasp login
```

–≠—Ç–æ –æ—Ç–∫—Ä–æ–µ—Ç –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

## –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Apps Script

### –í–∞—Ä–∏–∞–Ω—Ç A: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://script.google.com
2. –ù–∞–∂–º–∏—Ç–µ **"–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç"**
3. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç: **"–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Script ID** –∏–∑ URL:
   ```
   https://script.google.com/home/projects/–í–ê–®_SCRIPT_ID/edit
   ```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ Apps Script
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Script ID –∏–∑ URL

---

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .clasp.json

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è Script ID, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cd /Users/aleksandrprokudin/Documents/GW
echo '{"scriptId":"–í–ê–®_SCRIPT_ID","rootDir":"."}' > .clasp.json
```

**–í–ê–ñ–ù–û:** `.clasp.json` —É–∂–µ –≤ `.gitignore`, –æ–Ω –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

---

## –®–∞–≥ 4: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞

### 4.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ dialog.html

–ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ `dialog.html` –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `dialog.html`
2. –ó–∞–º–µ–Ω–∏—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
   - `DEVELOPER_KEY` = –≤–∞—à Client ID –∏–∑ Google Cloud Console
   - `CLOUD_PROJECT_NUMBER` = –≤–∞—à Project Number

### 4.2 –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞

```bash
clasp push
```

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –æ—à–∏–±–∫–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
```bash
clasp push --force
```

### 4.3 –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Apps Script
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å:
   - `appsScript.js`
   - `dialog.html`
   - `appsscript.json`

---

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

### 5.1 –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

```bash
cat ~/.clasprc.json
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å JSON –æ–±—ä–µ–∫—Ç.

### 5.2 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/alxprokudin/my-workspace-addons/settings/secrets/actions
2. –ù–∞–∂–º–∏—Ç–µ **"New repository secret"**

3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Å–µ–∫—Ä–µ—Ç:
   - **Name:** `CLASP_TOKEN`
   - **Value:** —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `~/.clasprc.json` (–≤–µ—Å—å JSON)

4. –î–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π —Å–µ–∫—Ä–µ—Ç:
   - **Name:** `CLASP_SCRIPT_ID`
   - **Value:** –≤–∞—à Script ID (–∏–∑ `.clasp.json`)

---

## –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

1. –í–Ω–µ—Å–∏—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ø—É—à—å—Ç–µ:
   ```bash
   git add appsScript.js
   git commit -m "Test automatic deployment"
   git push
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions:
   - –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/alxprokudin/my-workspace-addons/actions
   - –î–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è workflow "Deploy to Google Apps Script"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ ‚úÖ

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Apps Script:
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `excel-export-addon` –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –≤ Google Apps Script!

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "You do not have permission"
```bash
# –í–∫–ª—é—á–∏—Ç–µ Apps Script API:
# https://script.google.com/home/usersettings
# –í–∫–ª—é—á–∏—Ç–µ "Google Apps Script API"

# –ó–∞—Ç–µ–º:
clasp login
```

### –û—à–∏–±–∫–∞: "Script ID not found"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Script ID –≤ `.clasp.json`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Apps Script

### –û—à–∏–±–∫–∞ –≤ GitHub Actions
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `CLASP_TOKEN` - —ç—Ç–æ –ø–æ–ª–Ω—ã–π JSON –∏–∑ `~/.clasprc.json`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions

---

## üìù –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `clasp login`
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ Apps Script
- [ ] Script ID —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
- [ ] `.clasp.json` —Å–æ–∑–¥–∞–Ω
- [ ] `dialog.html` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏
- [ ] –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–ª–∞ (`clasp push`)
- [ ] GitHub Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π push –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
- [ ] –ö–æ–¥ –æ–±–Ω–æ–≤–∏–ª—Å—è –≤ Apps Script –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

