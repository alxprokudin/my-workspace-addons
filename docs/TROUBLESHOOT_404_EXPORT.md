# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 404 –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã `drive` –Ω–∞ `drive.file` scope –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ 404 –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ:
> "–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ 404"

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ç–∞–±–ª–∏—Ü–µ —á–µ—Ä–µ–∑ `docs.google.com`**
   - URL —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ `drive` scope
   - `drive.file` scope –º–æ–∂–µ—Ç –Ω–µ –¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–∫—Å–ø–æ—Ä—Ç—É —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç URL

2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å OAuth —Ç–æ–∫–µ–Ω–æ–º**
   - –¢–æ–∫–µ–Ω –º–æ–∂–µ—Ç –Ω–µ –∏–º–µ—Ç—å –Ω—É–∂–Ω—ã—Ö –ø—Ä–∞–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞

3. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º URL**
   - URL —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Drive API –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í–º–µ—Å—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ —á–µ—Ä–µ–∑ `docs.google.com`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Drive API:

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ Drive API
const exportUrl = `https://www.googleapis.com/drive/v3/files/${idSpreadsheet}/export?mimeType=application%2Fvnd.openxmlformats-officedocument.spreadsheetml.sheet`;

const response = UrlFetchApp.fetch(exportUrl, {
  headers: {
    Authorization: "Bearer " + ScriptApp.getOAuthToken()
  }
});
```

### –†–µ—à–µ–Ω–∏–µ 2: –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ `drive` scope

–ï—Å–ª–∏ Drive API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ `drive` scope:
- –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç CASA –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ù–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —ç–∫—Å–ø–æ—Ä—Ç—É

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SpreadsheetApp –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞

–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã Apps Script:

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ SpreadsheetApp (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤)
const file = DriveApp.createFile(`${nameActiveSheet}.xlsx`, blob);
```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –†–µ—à–µ–Ω–∏–µ 1 (Drive API –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞). –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–≤—Ä–∞—Ç –∫ `drive` scope.

