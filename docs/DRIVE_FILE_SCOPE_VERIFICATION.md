# ‚úÖ `drive.file` scope: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ë–ï–ó CASA

## üéØ –í–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ

**`drive.file` scope –ù–ï —Ç—Ä–µ–±—É–µ—Ç CASA –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏!**

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è scopes:

1. **Restricted scopes** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ) - —Ç—Ä–µ–±—É—é—Ç CASA:
   - `drive` - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Drive
   - –¢—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥—É—é –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ü–µ–Ω–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ($5,000-$15,000)

2. **Sensitive scopes** (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ) - —Ç—Ä–µ–±—É—é—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ –ë–ï–ó CASA:
   - `drive.file` - –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ Picker
   - –¢—Ä–µ–±—É—é—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é Google (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

3. **Non-sensitive scopes** (–Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ) - –Ω–µ —Ç—Ä–µ–±—É—é—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:
   - `spreadsheets.currentonly` - –¥–æ—Å—Ç—É–ø –∫ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
   - `drive.readonly` - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `drive.file` + –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç

### Scopes (–ë–ï–ó CASA):

```json
"oauthScopes": [
  "https://www.googleapis.com/auth/spreadsheets.currentonly",
  "https://www.googleapis.com/auth/drive.file",
  "https://www.googleapis.com/auth/script.external_request",
  "https://www.googleapis.com/auth/script.container.ui"
]
```

### –ü–æ–¥—Ö–æ–¥:

1. **–≠–∫—Å–ø–æ—Ä—Ç:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URL —Å `spreadsheets.currentonly` scope
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Drive API v3 –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É —á–µ—Ä–µ–∑ Picker (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `drive.file`)

### –ü—Ä–æ–±–ª–µ–º–∞:

–≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `docs.google.com/spreadsheets/.../export` –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å `spreadsheets.currentonly` scope.

### –†–µ—à–µ–Ω–∏–µ:

–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SpreadsheetApp.getBlob()` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞, –Ω–æ —ç—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å—é —Ç–∞–±–ª–∏—Ü—É, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç.

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URL, –Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ OAuth —Ç–æ–∫–µ–Ω —Å `spreadsheets.currentonly` scope.

