# üìß –û—Ç–≤–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é Google: –ü–µ—Ä–µ—Ö–æ–¥ —Å `drive` –Ω–∞ `drive.file`

## üìã –°—É—Ç—å –ø–∏—Å—å–º–∞ –æ—Ç Google

Google —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`drive.file`** –≤–º–µ—Å—Ç–æ **`drive`** scope –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ `drive.file`:

1. **–ù–µ —Ç—Ä–µ–±—É–µ—Ç CASA (Cloud App Security Assessment)**
   - `drive.file` - —ç—Ç–æ **non-sensitive scope**
   - –ù–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –¥–æ—Ä–æ–≥—É—é –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ü–µ–Ω–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ($5,000-$15,000)
   - –ù–µ –Ω—É–∂–Ω–æ –µ–∂–µ–≥–æ–¥–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ä–µ—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

2. **–õ—É—á—à–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –≤—ã–±–∏—Ä–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å **–ª—é–±–æ–π** —Ñ–∞–π–ª –∏–∑ –∏—Ö Drive
   - –í–∫–ª—é—á–∞—è —Ñ–∞–π–ª—ã, **–Ω–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º**
   - –ë–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

3. **–†–∞–±–æ—Ç–∞–µ—Ç —Å Google Picker**
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Picker –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–∞–ø–∫–∏
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å –ª—é–±—É—é –ø–∞–ø–∫—É –≤ –∏—Ö Drive
   - –í —è–Ω–≤–∞—Ä–µ 2025 –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `setFilelds` –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å `drive` scope:

1. **–¢—Ä–µ–±—É–µ—Ç CASA**
   - –≠—Ç–æ **restricted scope**
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ï–∂–µ–≥–æ–¥–Ω–∞—è —Ä–µ—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - –î–æ—Ä–æ–≥–æ –∏ –¥–æ–ª–≥–æ

---

## ü§î –ú–æ–∂–µ—Ç –ª–∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å `drive.file`?

### –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç:
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç Google Sheets –≤ Excel
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ Google Picker

### –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ —Å `drive.file`?

**–î–ê! ‚úÖ** `drive.file` –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã (–≤–∞—à Excel —Ñ–∞–π–ª)
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ Google Picker
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å **–ª—é–±—É—é** –ø–∞–ø–∫—É –≤ –∏—Ö Drive

**–í–∞–∂–Ω–æ:** Google –≤ –ø–∏—Å—å–º–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —É–ø–æ–º–∏–Ω–∞–µ—Ç, —á—Ç–æ `drive.file` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–±–∏—Ä–∞—Ç—å **–ª—é–±—ã–µ** —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏ –∏–∑ –∏—Ö Drive, –≤–∫–ª—é—á–∞—è —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `drive.file`

### –ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:

1. **–ò–∑–±–µ–∂–∏—Ç–µ CASA** - —Å—ç–∫–æ–Ω–æ–º–∏—Ç–µ $5,000-$15,000 –∏ –≤—Ä–µ–º—è
2. **–ë—ã—Å—Ç—Ä–µ–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** - non-sensitive scope –æ–¥–æ–±—Ä—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ
3. **–¢–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫ –∂–µ
4. **–õ—É—á—à–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –ò–∑–º–µ–Ω–∏—Ç—å scope –≤ –∫–æ–¥–µ

**–í `appsscript.json`:**

–ó–∞–º–µ–Ω–∏—Ç–µ:
```json
"oauthScopes": [
  "https://www.googleapis.com/auth/spreadsheets.currentonly",
  "https://www.googleapis.com/auth/drive",  // ‚ùå –£–±—Ä–∞—Ç—å
  "https://www.googleapis.com/auth/script.external_request",
  "https://www.googleapis.com/auth/script.container.ui"
]
```

–ù–∞:
```json
"oauthScopes": [
  "https://www.googleapis.com/auth/spreadsheets.currentonly",
  "https://www.googleapis.com/auth/drive.file",  // ‚úÖ –î–æ–±–∞–≤–∏—Ç—å
  "https://www.googleapis.com/auth/script.external_request",
  "https://www.googleapis.com/auth/script.container.ui"
]
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å OAuth Consent Screen

**–í Google Cloud Console:**
- APIs & Services ‚Üí OAuth consent screen
- –£–¥–∞–ª–∏—Ç–µ scope `drive`
- –î–æ–±–∞–≤—å—Ç–µ scope `drive.file`
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**–í Apps Script:**
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (deployment)
- –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

### –®–∞–≥ 4: –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ email

**–û—Ç–≤–µ—Ç (Option 1 - Recommended):**

```
Confirming narrower scopes
```

**–ò–ª–∏ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ:**

```
Hello,

Thank you for the recommendation. I have updated my application to use 
the drive.file scope instead of the drive scope. The changes have been 
made in both the codebase and the Cloud Console project.

The application will continue to work as expected, allowing users to 
select any folder in their Drive through Google Picker and save exported 
Excel files to the selected location.

Please proceed with the verification process.

Best regards,
[–í–∞—à–µ –∏–º—è]
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ!

**–ò–∑ –ø–∏—Å—å–º–∞ Google:**
> "DO NOT remove any previously approved scopes from your project at this time"

**–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- –ù–µ —É–¥–∞–ª—è–π—Ç–µ –¥—Ä—É–≥–∏–µ —É–∂–µ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ scopes
- –¢–æ–ª—å–∫–æ –∑–∞–º–µ–Ω–∏—Ç–µ `drive` –Ω–∞ `drive.file`
- –ù–µ —Ç—Ä–æ–≥–∞–π—Ç–µ `script.container.ui`, `script.external_request`, `spreadsheets.currentonly`

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–µ–π—Å—Ç–≤–∏–π

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å `drive` –Ω–∞ `drive.file` –≤ `appsscript.json`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å OAuth Consent Screen –≤ Google Cloud Console
- [ ] –£–¥–∞–ª–∏—Ç—å `drive` scope, –¥–æ–±–∞–≤–∏—Ç—å `drive.file` scope
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Apps Script
- [ ] –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ email: "Confirming narrower scopes"
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–ø–æ—Å–ª–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏)

---

## üîÑ –ï—Å–ª–∏ `drive.file` –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç (Option 2)

–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ `drive.file` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è (—á—Ç–æ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ), –æ—Ç–≤–µ—Ç—å—Ç–µ:

```
Unable to use narrower scopes
```

–ò –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ, –ø–æ—á–µ–º—É –Ω—É–∂–µ–Ω `drive` scope.

**–ù–æ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è —ç—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** - `drive.file` –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–ª–∏—á–Ω–æ!

---

## üéØ –ò—Ç–æ–≥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Option 1**

1. –ó–∞–º–µ–Ω–∏—Ç–µ `drive` –Ω–∞ `drive.file` –≤ –∫–æ–¥–µ
2. –û–±–Ω–æ–≤–∏—Ç–µ OAuth Consent Screen
3. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ email: "Confirming narrower scopes"
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–≠—Ç–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç –≤–∞–º –≤—Ä–µ–º—è –∏ –¥–µ–Ω—å–≥–∏, –∏–∑–±–µ–∂–∞–≤ CASA! üí∞

---

**–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ email –æ—Ç Google, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏!** üìß

