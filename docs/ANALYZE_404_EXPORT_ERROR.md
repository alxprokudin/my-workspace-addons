# üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏ 404 –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ 404 "–§–∞–π–ª –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω" –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —á–µ—Ä–µ–∑ URL:
```
https://docs.google.com/spreadsheets/d/${idSpreadsheet}/export?format=xlsx&gid=${idActiveSheet}
```

**–ü—Ä–∏—á–∏–Ω–∞:** –≠—Ç–æ—Ç endpoint —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ —á–µ—Ä–µ–∑ Drive API, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è `spreadsheets.currentonly` scope.

## üîç –ê–Ω–∞–ª–∏–∑ scopes

### –¢–µ–∫—É—â–∏–µ scopes:
- `spreadsheets.currentonly` - –¥–æ—Å—Ç—É–ø –∫ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ —á–µ—Ä–µ–∑ SpreadsheetApp
- `drive.file` - –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ Picker
- `script.external_request` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `script.container.ui` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ UI

### –ü—Ä–æ–±–ª–µ–º–∞ —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º —á–µ—Ä–µ–∑ URL:

–≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `docs.google.com/spreadsheets/.../export` —Ç—Ä–µ–±—É–µ—Ç:
- –î–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ —á–µ—Ä–µ–∑ Drive API (–Ω–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SpreadsheetApp)
- –≠—Ç–æ –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å `drive.readonly` –∏–ª–∏ `drive` scope

## ‚úÖ –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SpreadsheetApp.getBlob()

**–ü–ª—é—Å—ã:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Å `spreadsheets.currentonly` scope
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç Drive API

**–ú–∏–Ω—É—Å—ã:**
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç **–≤—Å—é —Ç–∞–±–ª–∏—Ü—É**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç
- –ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞

**–ö–æ–¥:**
```javascript
const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
const blob = spreadsheet.getBlob().setName(`${nameActiveSheet}.xlsx`);
```

### –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Sheets API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞—Ç—å Excel –≤—Ä—É—á–Ω—É—é

**–ü–ª—é—Å—ã:**
- –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∏—Å—Ç
- –†–∞–±–æ—Ç–∞–µ—Ç —Å `spreadsheets.currentonly` scope

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–µ–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Excel —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)

### –†–µ—à–µ–Ω–∏–µ 3: –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ SpreadsheetApp + –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–ø–∏—è –ª–∏—Å—Ç–∞

**–ò–¥–µ—è:**
1. –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é —Ç–∞–±–ª–∏—Ü—ã —Å –æ–¥–Ω–∏–º –ª–∏—Å—Ç–æ–º
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∫–æ–ø–∏—é —á–µ—Ä–µ–∑ SpreadsheetApp.getBlob()
3. –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é

**–ü–ª—é—Å—ã:**
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∏—Å—Ç
- –†–∞–±–æ—Ç–∞–µ—Ç —Å `spreadsheets.currentonly` scope

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–µ–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –¢—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –†–µ—à–µ–Ω–∏–µ 4: –î–æ–±–∞–≤–∏—Ç—å `drive.readonly` scope

**–ü–ª—é—Å—ã:**
- –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URL –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç CASA (readonly scope)

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–æ –Ω–µ CASA)
- –î–æ–±–∞–≤–ª—è–µ—Ç –µ—â–µ –æ–¥–∏–Ω scope

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –†–µ—à–µ–Ω–∏–µ 1 (SpreadsheetApp.getBlob())** - —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≥–ª–∞—Å–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ç–∞–±–ª–∏—Ü—É –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
- –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º–∏ scopes

**–ò–ª–∏ –†–µ—à–µ–Ω–∏–µ 4 (–¥–æ–±–∞–≤–∏—Ç—å drive.readonly)**:
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ª–∏—Å—Ç
- –¢—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ –Ω–µ CASA

