# üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ OAuth Scopes

## –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ `appsscript.json`

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ñ–∞–π–ª `appsscript.json`:

```json
{
  "oauthScopes": [
    "https://www.googleapis.com/auth/spreadsheets.currentonly",
    "https://www.googleapis.com/auth/script.container.ui",
    "https://www.googleapis.com/auth/script.external_request"
  ]
}
```

## –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ Apps Script —Ä–µ–¥–∞–∫—Ç–æ—Ä

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Apps Script —Ä–µ–¥–∞–∫—Ç–æ—Ä](https://script.google.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ü—Ä–æ–µ–∫—Ç** ‚Üí **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞** (Project ‚Üí Project settings)
4. –í —Ä–∞–∑–¥–µ–ª–µ **"OAuth scopes"** –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ scopes

## –ú–µ—Ç–æ–¥ 3: –ß–µ—Ä–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

–î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ `appsScript.js`:

```javascript
function checkScopes() {
  const scopes = ScriptApp.getOAuthScopes();
  Logger.log('Current OAuth Scopes:');
  scopes.forEach(scope => Logger.log(scope));
  
  // –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –≤ UI
  SpreadsheetApp.getUi().alert('Scopes:\n' + scopes.join('\n'));
}
```

–ó–∞—Ç–µ–º:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `checkScopes()` –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ (–í–∏–¥ ‚Üí –õ–æ–≥–∏) –∏–ª–∏ –¥–∏–∞–ª–æ–≥

## –ú–µ—Ç–æ–¥ 4: –ß–µ—Ä–µ–∑ Google Cloud Console

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **APIs & Services** ‚Üí **OAuth consent screen**
4. –í —Ä–∞–∑–¥–µ–ª–µ **"Scopes"** –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–µ scopes

## –ú–µ—Ç–æ–¥ 5: –ß–µ—Ä–µ–∑ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment)

1. –í Apps Script —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** ‚Üí **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è–º–∏**
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
3. –í —Ä–∞–∑–¥–µ–ª–µ **"Authorization"** –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ scopes

## –¢–µ–∫—É—â–∏–µ scopes –≤ –ø—Ä–æ–µ–∫—Ç–µ

–í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ scopes:

1. **`spreadsheets.currentonly`** - –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ç–µ–∫—É—â–µ–π –æ—Ç–∫—Ä—ã—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ
2. **`script.container.ui`** - –î–æ—Å—Ç—É–ø –∫ UI (–¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–∏–∞–ª–æ–≥–æ–≤)
3. **`script.external_request`** - –î–æ—Å—Ç—É–ø –∫ –≤–Ω–µ—à–Ω–∏–º HTTP –∑–∞–ø—Ä–æ—Å–∞–º (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —á–µ—Ä–µ–∑ URL)

## –í–∞–∂–Ω–æ

- Scopes –≤ `appsscript.json` - —ç—Ç–æ **–∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–µ** scopes
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ scopes –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –æ–¥–æ–±—Ä–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ **—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö** scopes –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ú–µ—Ç–æ–¥ 3 (—á–µ—Ä–µ–∑ `ScriptApp.getOAuthScopes()`)

