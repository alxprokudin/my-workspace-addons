# üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ scopes –±–µ–∑ CASA –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

## üéØ –¶–µ–ª—å

–ù–∞–π—Ç–∏ —Å–ø–æ—Å–æ–± —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ Excel –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–∞–ø–∫—É **–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `drive` scope**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å CASA –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üìã –ê–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 1: `spreadsheets.currentonly` + `drive.file` + Google Picker

**–ò–¥–µ—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SpreadsheetApp.getBlob()` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `spreadsheets.currentonly`)
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —á–µ—Ä–µ–∑ Drive API v3 –≤ –ø–∞–ø–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é —á–µ—Ä–µ–∑ Google Picker (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `drive.file`)

**Scopes:**
```json
"oauthScopes": [
  "https://www.googleapis.com/auth/spreadsheets.currentonly",
  "https://www.googleapis.com/auth/drive.file",
  "https://www.googleapis.com/auth/script.external_request",
  "https://www.googleapis.com/auth/script.container.ui"
]
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `SpreadsheetApp.getBlob()` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç **–≤—Å—é —Ç–∞–±–ª–∏—Ü—É**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URL + `drive.file` + Google Picker

**–ò–¥–µ—è:**
- –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `docs.google.com/spreadsheets/.../export` (–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å `spreadsheets.currentonly`)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Drive API v3 –≤ –ø–∞–ø–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é —á–µ—Ä–µ–∑ Picker (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `drive.file`)

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URL –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ `drive` scope.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `spreadsheets.currentonly` + –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

**–ò–¥–µ—è:**
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `SpreadsheetApp.getBlob()`
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–∞–ø–∫—É).

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –í–∞—Ä–∏–∞–Ω—Ç 1 —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### –ü–æ–¥—Ö–æ–¥:

1. **–≠–∫—Å–ø–æ—Ä—Ç:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SpreadsheetApp.getBlob()` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Drive API v3 –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é —á–µ—Ä–µ–∑ Picker
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ç–∞–±–ª–∏—Ü—É (–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç)

### –ö–æ–¥:

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ SpreadsheetApp (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å spreadsheets.currentonly)
const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
const blob = spreadsheet.getBlob().setName(`${spreadsheet.getName()}.xlsx`);

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Drive API v3 (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å drive.file + Picker)
const driveApiUrl = 'https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable';
const metadata = {
  name: `${spreadsheet.getName()}.xlsx`,
  parents: [idFolder]
};
// ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤—Å—è —Ç–∞–±–ª–∏—Ü–∞, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç.

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç:

1. –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é —Ç–∞–±–ª–∏—Ü—ã —Å –æ–¥–Ω–∏–º –ª–∏—Å—Ç–æ–º
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∫–æ–ø–∏—é
3. –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é

–ù–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

## üìù –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- `spreadsheets.currentonly` - –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ
- `drive.file` - –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É —á–µ—Ä–µ–∑ Picker
- –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ `SpreadsheetApp.getBlob()`

**–ò–ª–∏:**
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ —á–µ—Ä–µ–∑ URL + `drive.file` (–µ—Å–ª–∏ URL —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `spreadsheets.currentonly`)

